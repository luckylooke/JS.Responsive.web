




<h1 class="page-title">Source: detectAgent.js</h1><div class="" id="toc-content"><div class="container">
<div class="row">

	
	<div class="col-md-12">
	
		<div id="main">
			

		
    
<section>
    <article>
        <pre class="sunlight-highlight-javascript linenums">/**
 *
 * @module detectAgent
 *
 */

/** Set watching given browser and its version
 * @param {String} browser - browser name, see function getAgentData() attribute &quot;identity&quot;
 * @param {Number} version - browser version number
 * @returns {Object} this - for chaining.
 * @example JS.Responsive.watchBrowserVersion(&apos;Webkit&apos;, 530);
 * @example JS.Responsive.watchBrowserVersion(&apos;Chrome&apos;, 47);
 * @example JS.Responsive.watchBrowserVersion(&apos;MSIE&apos;, 10);
 * @example JS.Responsive.watchBrowserVersion(&apos;Edge&apos;, 12);
 * @memberof module:detectAgent
 * @alias JS.Responsive.watchBrowserVersion
 */
$C.watchBrowserVersion = function( browser, version ) {

    var agentData = findAgentDataByBrowserName( browser );

    if (agentData)
        addBrowserVersionClasses( agentData, version );
    else
        throw new Error(&quot;Browser &apos;&quot; + browser + &quot;&apos; was not found.&quot;);

    if (agentData &amp;&amp; !agentData.versionSearch)
        throw new Error(&quot;Parameter &apos;&quot; + browser + &quot;&apos; doesn&apos;t support version search.&quot;);

    return this;
};

/**
 * Returns information about platform, browser and its version
 * @returns {Object} containing &quot;platform&quot; as array, &quot;browser&quot; as string and &quot;version&quot; as number.
 * @example JS.Responsive.getPlatformInfo() returns
 *   {
	 *		platform: Array[&quot;webkit&quot;, &quot;windows&quot;, &quot;chrome&quot;],
	 *		browser: &quot;chrome&quot;,
	 *		version: 43.5
	 *   }
 * @memberof module:detectAgent
 * @alias JS.Responsive.getPlatformInfo
 */
$C.getPlatformInfo = function() {

    return detectAgentPlatform(TRUE);
};
/**
 * Returns browser tags
 * @returns {Array} all browser tags strings in Array.
 * @method
 * @memberof module:detectAgent
 * @alias JS.Responsive.getAgentTags
 **/

$C.getAgentTags = getAgentTags;

$C.features.detectAgent = detectAgentPlatform;

// Declarations:

function findAgentDataByBrowserName( browser ) {

    var data = getAgentData();
    browser = browser.toLowerCase();
    for (var i = 0; i &lt; data.length; i++) {
        if (browser == data[i].identity.toLowerCase())
            return data[i];
    }
    return NULL;
}

function addBrowserVersionClasses( agentData, version ) {

    if (agentData.versionSearch) {
        var browser = agentData.identity.toLowerCase(),
            actualVersion = parseFloat(navigator.userAgent.split(agentData.versionSearch || agentData.identity)[1]);
        if ((version + EMPTY_STRING).indexOf(&apos;.&apos;) == -1)
            actualVersion = parseInt(actualVersion);

        if (!isNaN(actualVersion)) {

            if (version == actualVersion) {
                addClass(browser + &apos;-v&apos; + version + &apos;-le&apos;);
                addClass(browser + &apos;-v&apos; + version + &apos;-ge&apos;);
            }

            if (version &gt; actualVersion)
                addClass(browser + &apos;-v&apos; + version + &apos;-l&apos;);

            if (version &lt; actualVersion)
                addClass(browser + &apos;-v&apos; + version + &apos;-g&apos;);

            return TRUE;
        }
    }
    return FALSE;
}

function detectAgentPlatform(_justReturnValue) {

    var data = getAgentData(),
        foundBrowser = FALSE,
        returnValue = {
            platform: [],
            browser: [],
            version: NULL
        };

    for (var i = 0; i &lt; data.length; i++) {

        var dataString = data[i].string,
            dataProp = data[i].prop;

        if ((dataString || dataProp) &amp;&amp; (!foundBrowser || !data[i].versionSearch)) {
            if (dataProp || dataString.indexOf(data[i].subString) != -1) {
                var clsName = data[i].identity.toLowerCase();
                if (_justReturnValue)
                    returnValue.platform.push(clsName);
                else
                    addClass(clsName);
                if (data[i].versionSearch) {
                    var version = parseFloat(navigator.userAgent.split(data[i].versionSearch || data[i].identity)[1]);

                    if (clsName != &apos;webkit&apos;)
                        foundBrowser = TRUE; // this is exception for webkit

                    if (!isNaN(version)) {
                        if (_justReturnValue)
                            returnValue.version = version;
                        else
                        // if more classes with spaces, adds versions to all classes
                        // (e.g. msie-v11 wow-v11)
                            addClass(clsName.replace(/( |$)/g, &apos;-v&apos; + parseInt(version)+&apos; &apos;).trim() );
                        if (version != parseInt(version) &amp;&amp; !_justReturnValue)
                        // if more classes with spaces, adds versions to all classes
                            addClass(clsName.replace(/( |$)/g, &apos;-v&apos; + version.toString().replace(&apos;.&apos;, &apos;-&apos;)+&apos; &apos;).trim() );
                    }
                }
            }
        }
    }
    if (_justReturnValue) {
        returnValue.browser = returnValue.platform[returnValue.platform.length - 1];
        return returnValue;
    }
}

// SOURCE: http://www.quirksmode.org/js/detect.html
// no longer supported / updated
// @todo update/test on new browsers
function getAgentData() {
    var nua = navigator.userAgent,
        np = navigator.platform,
        nv = navigator.vendor,
        nall = nua + SPACE_CHAR + np + SPACE_CHAR + nv,
        agentList = [];

    function add(identity, string, subString, versionSearch, prop) {
        agentList.push({
            identity: identity,
            string: string,
            subString: subString==UNDEFINED ? identity : subString,
            versionSearch: versionSearch!==TRUE ? versionSearch : identity+&apos;/&apos;,
            prop: prop
        });
    }
    add(&quot;Edge&quot;, nua, NULL, TRUE);
    add(&quot;Webkit&quot;, nua, NULL, TRUE);
    add(&quot;Android&quot;, nall);
    add(&quot;CoreMedia&quot;, nall);
    add(&quot;QuickTime&quot;, nall);
    add(&quot;BlackBerry&quot;, nall);
    add(&quot;Windows&quot;, np, &quot;Win&quot;);
    add(&quot;Mac&quot;, np);
    add(&quot;MacOSX&quot;, nua, &quot;Intel Mac OS X&quot;); // because on iPhone is &quot;like Mac OS X&quot;
    add(&quot;iPhone&quot;, nua);
    add(&quot;iOS&quot;, nua, &quot;iPhone&quot;);
    add(&quot;iPad&quot;, nall);
    add(&quot;iOS&quot;, nall, &quot;iPad&quot;);
    add(&quot;iPod&quot;, nall);
    add(&quot;iOS&quot;, nall, &quot;iPod&quot;);
    add(&quot;PSP&quot;, nall); //PlayStation Portable
    add(&quot;Kindle&quot;, nall);
    add(&quot;Linux&quot;, np);
    add(&quot;Maxthon&quot;, nua, NULL, TRUE);
    add(&quot;Chrome&quot;, nua, NULL, TRUE);
    add(&quot;OmniWeb&quot;, nua, NULL, TRUE);
    add(&quot;Safari&quot;, nv, &quot;Apple&quot;, &quot;Version/&quot;);
    add(&quot;Opera&quot;, UNDEFINED, NULL, &quot;Version/&quot;, win.opera);
    add(&quot;OperaMini&quot;, nall, &quot;Opera Mini&quot;);
    add(&quot;iCab&quot;, nv);
    add(&quot;Konqueror&quot;, nv, &quot;KDE&quot;);
    add(&quot;Firefox&quot;, nua, NULL, TRUE);
    add(&quot;Camino&quot;, nv);
    add(&quot;Netscape&quot;, nua); // for newer Netscapes (6+)
    add(&quot;MSIE&quot;, nua, NULL, &quot;MSIE&quot;);
    add(&quot;MSIE WOW&quot;, nua, &quot;WOW64&quot;, &quot;rv:&quot;);
    add(&quot;Mozilla&quot;, nua, &quot;Gecko&quot;, &quot;rv&quot;);
    add(&quot;Mozilla&quot;, nua, NULL, &quot;Mozilla&quot;); // for older Netscapes (4-)

    return agentList;

}


 function getAgentTags() {
     for (var i = 0, data = getAgentData(), tags = []; i &lt; data.length; i++)
     tags.push(data[i].identity.toLowerCase());
     return tags;
 }
</pre>
    </article>
</section>





		</div>
	</div>

	<div class="clearfix"></div>

	

</div>
</div>&gt;</div>


    <div class="modal fade" id="searchResults">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&#xD7;</span></button>
            <h4 class="modal-title">Search results</h4>
          </div>
          <div class="modal-body"></div>
          <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
          </div>
        </div><!-- /.modal-content -->
      </div><!-- /.modal-dialog -->
    </div>


<footer>


<span class="jsdoc-message">
	Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.3</a>
	
		on Nov 20, 2016 9:55 AM
	
	using the <a href="https://github.com/docstrap/docstrap">DocStrap template</a>.
</span>
</footer>




    






<!--Navigation and Symbol Display-->




<!--Google Analytics-->



    


